一、基于局部密度聚类算法——Density Peaks

1、背景介绍
Density Peaks聚类算法是在2014年 6 月份，
由Alex Rodriguez 和 Alessandro Laio 在 Science
上发表了一篇名为《Clustering by fast search and find of density peaks》的文章，
这为聚类算法的设计提供了一种新的思路。

虽然这个算法从Science上发表后受到争议
——部分学者觉得这篇思想简单、操作方便的聚类算法还达不到能在Science上发表的水平。
这可能也是其他学者的恨吧。
值得一提的是，发现Density Peaks聚类算法的两位科学家
都不是研究数学，也不是研究算法分析的，
而是西班牙研究化学的科学家。

2、定义局部密度大小——ρi  （$\rho$)
Density Peaks聚类算法要是用文字描述是有一些费解的，我尽量用图解释一下：
下图是一个样本空间点的分布图，一共分布着28个点：

- 事先给定一个邻域半径dc，定义任意i、j两点的距离用dij表示；
- ρi表示i点的密度大小，
    i点的密度大小是如何确定的呢——
    以i点为圆心，包含在半径大小为dc的圆内点的个数即为i点的密度大小
    （与DBSCAN密度确定方法相似）；
- 数学公式如下右所示，即比较两点距离dij与领域半径dc的大小关系，
    小于表示在圆内，计数1，大于表示圆外，计数0，最后求和。
可得的结论：ρi越大表示点i的局部密度越大，越有可能成为聚类中心。


3、定义聚类中心距离——δi  ($\delta$)
Density Peaks聚类算法的巧妙之处：
    就是在于聚类中心距离δi的选定。

根据局部密度的定义，我们可以计算出上图中每个点的密度，依照密度确定聚类中心距离δi
a. 首先将每个点的密度从大到小排列：ρi>ρj>ρk>….；
    密度最大的点的聚类中心距离与其他点的聚类中心距离的确定方法是不一样的；
b. 先确定密度最大的点的聚类中心距离——i点是密度最大的点，
    它的聚类中心距离δi等于与i点最远的那个点n到点i的直线距离din；
再确定其他点的聚类中心距离——其他点的聚类中心距离是等于在密度大于该点的点集合中，与该点距离最小的的那个距离。例如i、j、k的密度都比n点的密度大，且j点离n点最近，则n点的聚类中心距离等于djn
依次确定所有的聚类中心距离δ
聚类中心距离δ的数学式如下：（虽然我觉得这个数学式表达的不是很贴切）


4、决策图确定聚类簇核心、簇边缘
Density Peaks聚类算法就是依据每个点的局部密度大小ρi、聚类中心距离δi的数值，
组合(ρi，δi)投射到二维坐标系中。

先上决策图：

（这里聚类中心距离经过归一化处理，将①号点的聚类中心距离δ1,27定为1）

从B图中可以清楚的看出来：

分布在右上角区域的是聚类的核心点：周围密度很大，且没有其他核心点；
分布在靠近ρ轴的值是属于正常值：密度虽然大，但是周围有比它更合适作为核心点的点；
分布在靠近δ轴的值是属于噪声点：周围密度小，而且离其他点的距离还远


现实意义就是：
北京联合天津、廊坊等地构成帝都经济群，
上海联合无锡、常州、苏州构成长江三角洲经济群，
广州深圳形成珠三角经济群。
北京、上海、广州相当于聚类核心点；
天津虽然也很发达，但是由于它离北京很近，所以天津只能是正常点。

5、Density Peaks聚类算法的意义
聚类算法中最困惑的地方就是选定K值等于多少才算合适，
Density Peaks聚类算法给出了一种比较好的确定K值的方式：
定义γi=ρi*δi，得到的乘积比较选取较大的K个点作为聚类中心